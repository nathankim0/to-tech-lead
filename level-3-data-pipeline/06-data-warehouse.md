# Data Warehouse

## 1. í•œ ì¤„ ìš”ì•½

ë¶„ì„ê³¼ ì˜ì‚¬ê²°ì •ì„ ìœ„í•´ **ì •ì œë˜ê³  êµ¬ì¡°í™”ëœ ë°ì´í„°**ë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ì•™ ì €ì¥ì†Œì…ë‹ˆë‹¤.

---

## 2. ì‰½ê²Œ ì„¤ëª…

### ëª¨ë°”ì¼ ê°œë°œì ê´€ì ì˜ ë¹„ìœ 

**ë„ì„œê´€**ì„ ìƒê°í•´ë³´ì„¸ìš”.

| ê°œë… | ë„ì„œê´€ | Data Warehouse |
|------|--------|----------------|
| ì›ë³¸ ìë£Œ | ê¸°ì¦ë°›ì€ ê°ì¢… ë¬¸ì„œ | ì›ì‹œ ë¡œê·¸ (Data Lake) |
| ì •ë¦¬ëœ ìë£Œ | ë¶„ë¥˜ëœ ì¥ì„œ | ì •ì œëœ í…Œì´ë¸” |
| ê²€ìƒ‰ ì‹œìŠ¤í…œ | ë„ì„œ ê²€ìƒ‰ DB | ë¶„ì„ ì¿¼ë¦¬ |
| ì‚¬ì„œ | ìë£Œ ì •ë¦¬ ë‹´ë‹¹ | ETL íŒŒì´í”„ë¼ì¸ |
| ì—´ëŒì‹¤ | ìë£Œ ì¡°íšŒ ê³µê°„ | BI ë„êµ¬ |

ë„ì„œê´€ì—ì„œ ì±…ì´ ì˜ ë¶„ë¥˜ë˜ì–´ ìˆì–´ì•¼ ì›í•˜ëŠ” ì •ë³´ë¥¼ ë¹¨ë¦¬ ì°¾ì„ ìˆ˜ ìˆë“¯ì´, Data Warehouseë„ ë°ì´í„°ê°€ ì˜ êµ¬ì¡°í™”ë˜ì–´ ìˆì–´ì•¼ ë¹ ë¥¸ ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### Data Lake vs Data Warehouse

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DATA LAKE vs DATA WAREHOUSE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Data Lake (S3)                     Data Warehouse (Redshift)           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ ğŸ“„ JSON             â”‚           â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â” â”‚             â”‚
â”‚  â”‚ ğŸ“Š CSV              â”‚    ETL    â”‚ â”‚ id  â”‚name â”‚valueâ”‚ â”‚             â”‚
â”‚  â”‚ ğŸ“‹ Parquet          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚             â”‚
â”‚  â”‚ ğŸ–¼ï¸ Images           â”‚           â”‚ â”‚ 1   â”‚ A   â”‚ 100 â”‚ â”‚             â”‚
â”‚  â”‚ ğŸ“¹ Videos           â”‚           â”‚ â”‚ 2   â”‚ B   â”‚ 200 â”‚ â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜ â”‚             â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  íŠ¹ì§•:                              íŠ¹ì§•:                                â”‚
â”‚  â€¢ ì›ë³¸ ê·¸ëŒ€ë¡œ ì €ì¥                  â€¢ ìŠ¤í‚¤ë§ˆ ê°•ì œ                        â”‚
â”‚  â€¢ ìŠ¤í‚¤ë§ˆ ì—†ìŒ                       â€¢ ë¶„ì„ì— ìµœì í™”                      â”‚
â”‚  â€¢ ì €ë ´í•œ ë¹„ìš©                       â€¢ ë¹ ë¥¸ ì¿¼ë¦¬ ì„±ëŠ¥                     â”‚
â”‚  â€¢ ëª¨ë“  í˜•ì‹                         â€¢ í…Œì´ë¸” í˜•ì‹ë§Œ                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì™œ Data Warehouseê°€ í•„ìš”í•œê°€?

```
âŒ Data Lakeì— ì§ì ‘ ì¿¼ë¦¬í•˜ë©´...
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â€¢ ì¿¼ë¦¬ ì†ë„: ëŠë¦¼ (íŒŒì¼ ìŠ¤ìº” í•„ìš”)                           â”‚
â”‚  â€¢ ë°ì´í„° í’ˆì§ˆ: ë³´ì¥ ì•ˆ ë¨                                   â”‚
â”‚  â€¢ ìŠ¤í‚¤ë§ˆ: ì—†ê±°ë‚˜ ë¶ˆì¼ì¹˜                                     â”‚
â”‚  â€¢ ì¡°ì¸: ì–´ë µê³  ëŠë¦¼                                         â”‚
â”‚  â€¢ ì‚¬ìš©ì: ì—”ì§€ë‹ˆì–´ë§Œ ê°€ëŠ¥                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Data Warehouseë¥¼ ì‚¬ìš©í•˜ë©´...
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â€¢ ì¿¼ë¦¬ ì†ë„: ë¹ ë¦„ (ì¸ë±ìŠ¤, ìµœì í™”)                          â”‚
â”‚  â€¢ ë°ì´í„° í’ˆì§ˆ: ETLì—ì„œ ê²€ì¦ë¨                               â”‚
â”‚  â€¢ ìŠ¤í‚¤ë§ˆ: ëª…í™•í•˜ê²Œ ì •ì˜ë¨                                   â”‚
â”‚  â€¢ ì¡°ì¸: ì‰½ê³  ë¹ ë¦„ (ì‚¬ì „ ëª¨ë¸ë§)                             â”‚
â”‚  â€¢ ì‚¬ìš©ì: ë¶„ì„ê°€, PMë„ ì‚¬ìš© ê°€ëŠ¥                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨

### ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA WAREHOUSE ARCHITECTURE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SOURCE SYSTEMS                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ App Logs â”‚  â”‚ Server DBâ”‚  â”‚ 3rd Partyâ”‚  â”‚ External â”‚               â”‚
â”‚  â”‚  (S3)    â”‚  â”‚  (RDS)   â”‚  â”‚  (GA)    â”‚  â”‚  (API)   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ETL / ELT     â”‚
                    â”‚  (Airflow/dbt)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATA WAREHOUSE (Redshift / BigQuery / Snowflake)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  RAW LAYER (Bronze)                                                â”‚ â”‚
â”‚  â”‚  â€¢ ì›ë³¸ ë°ì´í„° ê·¸ëŒ€ë¡œ                                               â”‚ â”‚
â”‚  â”‚  â€¢ raw_events, raw_users, raw_orders                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STAGING LAYER (Silver)                                            â”‚ â”‚
â”‚  â”‚  â€¢ ì •ì œ ë° í‘œì¤€í™”                                                   â”‚ â”‚
â”‚  â”‚  â€¢ stg_events, stg_users, stg_orders                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MART LAYER (Gold)                                                 â”‚ â”‚
â”‚  â”‚  â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì ìš©                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚ fact_orders â”‚  â”‚ dim_users   â”‚  â”‚ dim_productsâ”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
         â–¼                   â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Tableau â”‚        â”‚ Looker  â”‚        â”‚ Metabaseâ”‚
    â”‚(BI Tool)â”‚        â”‚(BI Tool)â”‚        â”‚(BI Tool)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ (Star Schema)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STAR SCHEMA                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚   dim_date      â”‚                              â”‚
â”‚                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                              â”‚
â”‚                        â”‚  â”‚ date_key  â”‚  â”‚                              â”‚
â”‚                        â”‚  â”‚ date      â”‚  â”‚                              â”‚
â”‚                        â”‚  â”‚ month     â”‚  â”‚                              â”‚
â”‚                        â”‚  â”‚ quarter   â”‚  â”‚                              â”‚
â”‚                        â”‚  â”‚ year      â”‚  â”‚                              â”‚
â”‚                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                 â”‚                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    â”‚   dim_user      â”‚         â”‚         â”‚  dim_product    â”‚           â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚
â”‚    â”‚  â”‚ user_key  â”‚  â”‚         â”‚         â”‚  â”‚product_keyâ”‚  â”‚           â”‚
â”‚    â”‚  â”‚ user_id   â”‚  â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”‚  â”‚product_id â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ name      â”‚â—€â”€â”¼â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”¼â”€â–¶â”‚ name      â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ email     â”‚  â”‚    â”‚  FACT   â”‚    â”‚  â”‚ category  â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ segment   â”‚  â”‚    â”‚ ORDERS  â”‚    â”‚  â”‚ price     â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ join_date â”‚  â”‚    â”‚         â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚ order_idâ”‚    â”‚                 â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ user_keyâ”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                           â”‚date_key â”‚                                    â”‚
â”‚                           â”‚prod_key â”‚                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ amount  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    â”‚   dim_channel   â”‚    â”‚quantity â”‚    â”‚  dim_region     â”‚           â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚ channel â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚
â”‚    â”‚  â”‚channel_keyâ”‚â—€â”€â”¼â”€â”€â”€â”€â”‚ region  â”‚â”€â”€â”€â”€â”¼â”€â–¶â”‚region_key â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ name      â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚ country   â”‚  â”‚           â”‚
â”‚    â”‚  â”‚ type      â”‚  â”‚                   â”‚  â”‚ city      â”‚  â”‚           â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                          â”‚
â”‚  FACT TABLE: ì¸¡ì •ê°’ (ë§¤ì¶œ, ìˆ˜ëŸ‰ ë“±)                                      â”‚
â”‚  DIMENSION TABLE: ë¶„ì„ ê´€ì  (ëˆ„ê°€, ì–¸ì œ, ë¬´ì—‡ì„)                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ì†”ë£¨ì…˜ ë¹„êµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DATA WAREHOUSE SOLUTIONS                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Amazon Redshift                                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ AWS ë„¤ì´í‹°ë¸Œ                                                  â”‚   â”‚
â”‚  â”‚  â€¢ ì»¬ëŸ¼ ê¸°ë°˜ ì €ì¥                                                â”‚   â”‚
â”‚  â”‚  â€¢ Spectrumìœ¼ë¡œ S3 ì§ì ‘ ì¿¼ë¦¬                                     â”‚   â”‚
â”‚  â”‚  â€¢ ê°€ê²©: ì‹œê°„ë‹¹ $0.25~ (ë…¸ë“œ ê¸°ë°˜)                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Google BigQuery                                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ ì™„ì „ ì„œë²„ë¦¬ìŠ¤                                                 â”‚   â”‚
â”‚  â”‚  â€¢ ìŠ¤ìº” ë°ì´í„° ê¸°ë°˜ ê³¼ê¸ˆ                                         â”‚   â”‚
â”‚  â”‚  â€¢ ML ê¸°ëŠ¥ ë‚´ì¥ (BigQuery ML)                                    â”‚   â”‚
â”‚  â”‚  â€¢ ê°€ê²©: $5/TB ìŠ¤ìº”                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Snowflake                                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ í´ë¼ìš°ë“œ ë…ë¦½ì  (AWS, GCP, Azure)                             â”‚   â”‚
â”‚  â”‚  â€¢ ìŠ¤í† ë¦¬ì§€/ì»´í“¨íŒ… ë¶„ë¦¬                                          â”‚   â”‚
â”‚  â”‚  â€¢ ë°ì´í„° ê³µìœ  ê¸°ëŠ¥                                              â”‚   â”‚
â”‚  â”‚  â€¢ ê°€ê²©: í¬ë ˆë”§ ê¸°ë°˜                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ì‹¤ë¬´ ì ìš© ì˜ˆì‹œ

### 4.1 dbtë¥¼ ì‚¬ìš©í•œ ë°ì´í„° ëª¨ë¸ë§

```sql
-- models/staging/stg_events.sql
-- Staging Layer: ì›ì‹œ ë°ì´í„° ì •ì œ

{{
  config(
    materialized='incremental',
    unique_key='event_id',
    partition_by={
      "field": "event_date",
      "data_type": "date"
    }
  )
}}

WITH source AS (
    SELECT * FROM {{ source('raw', 'app_events') }}
    {% if is_incremental() %}
    WHERE event_date > (SELECT MAX(event_date) FROM {{ this }})
    {% endif %}
),

cleaned AS (
    SELECT
        -- ê³ ìœ  ì‹ë³„ì
        {{ dbt_utils.generate_surrogate_key(['user_id', 'event_timestamp', 'event_name']) }} AS event_id,

        -- íƒ€ì„ìŠ¤íƒ¬í”„ ì •ê·œí™”
        CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
        CAST(event_timestamp AS DATE) AS event_date,

        -- í•„ë“œ í‘œì¤€í™”
        LOWER(TRIM(event_name)) AS event_name,
        user_id,
        device_id,

        -- íŒŒë¼ë¯¸í„° ì¶”ì¶œ
        JSON_EXTRACT_SCALAR(params, '$.screen_name') AS screen_name,
        JSON_EXTRACT_SCALAR(params, '$.product_id') AS product_id,
        CAST(JSON_EXTRACT_SCALAR(params, '$.value') AS FLOAT64) AS event_value,

        -- ë©”íƒ€ë°ì´í„°
        CURRENT_TIMESTAMP() AS _loaded_at
    FROM source
    WHERE event_name IS NOT NULL
      AND user_id IS NOT NULL
)

SELECT * FROM cleaned
```

```sql
-- models/marts/core/dim_users.sql
-- Dimension Table: ì‚¬ìš©ì ì •ë³´

{{
  config(
    materialized='table'
  )
}}

WITH users AS (
    SELECT * FROM {{ ref('stg_users') }}
),

user_first_event AS (
    SELECT
        user_id,
        MIN(event_date) AS first_event_date,
        MIN(CASE WHEN event_name = 'purchase' THEN event_date END) AS first_purchase_date
    FROM {{ ref('stg_events') }}
    GROUP BY user_id
),

final AS (
    SELECT
        u.user_id,
        u.user_name,
        u.email,
        u.created_at AS signup_date,
        e.first_event_date,
        e.first_purchase_date,

        -- ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ê³„ì‚°
        CASE
            WHEN e.first_purchase_date IS NOT NULL THEN 'Buyer'
            WHEN DATE_DIFF(CURRENT_DATE(), e.first_event_date, DAY) <= 7 THEN 'New User'
            ELSE 'Active User'
        END AS user_segment,

        -- SCD Type 2 ì§€ì›
        CURRENT_TIMESTAMP() AS valid_from,
        CAST(NULL AS TIMESTAMP) AS valid_to,
        TRUE AS is_current
    FROM users u
    LEFT JOIN user_first_event e ON u.user_id = e.user_id
)

SELECT * FROM final
```

```sql
-- models/marts/core/fact_orders.sql
-- Fact Table: ì£¼ë¬¸ ì •ë³´

{{
  config(
    materialized='incremental',
    unique_key='order_id',
    partition_by={
      "field": "order_date",
      "data_type": "date"
    }
  )
}}

WITH orders AS (
    SELECT * FROM {{ ref('stg_orders') }}
    {% if is_incremental() %}
    WHERE order_date > (SELECT MAX(order_date) FROM {{ this }})
    {% endif %}
),

order_items AS (
    SELECT * FROM {{ ref('stg_order_items') }}
),

aggregated AS (
    SELECT
        o.order_id,
        o.order_date,
        o.user_id,
        o.order_status,

        -- Dimension keys (ì¡°ì¸ìš©)
        {{ dbt_utils.generate_surrogate_key(['o.user_id']) }} AS user_key,
        {{ dbt_utils.generate_surrogate_key(['o.order_date']) }} AS date_key,

        -- Measures (ì¸¡ì •ê°’)
        COUNT(DISTINCT oi.product_id) AS product_count,
        SUM(oi.quantity) AS total_quantity,
        SUM(oi.unit_price * oi.quantity) AS gross_amount,
        SUM(oi.discount_amount) AS discount_amount,
        SUM(oi.unit_price * oi.quantity - oi.discount_amount) AS net_amount,

        -- ë©”íƒ€ë°ì´í„°
        CURRENT_TIMESTAMP() AS _loaded_at
    FROM orders o
    LEFT JOIN order_items oi ON o.order_id = oi.order_id
    GROUP BY 1, 2, 3, 4, 5, 6
)

SELECT * FROM aggregated
```

### 4.2 Redshift í…Œì´ë¸” ìƒì„± ì˜ˆì‹œ

```sql
-- ì‚¬ìš©ì Dimension í…Œì´ë¸”
CREATE TABLE dim_users (
    user_key BIGINT IDENTITY(1,1) PRIMARY KEY,
    user_id VARCHAR(64) NOT NULL,
    user_name VARCHAR(256),
    email VARCHAR(256),
    signup_date DATE,
    first_event_date DATE,
    first_purchase_date DATE,
    user_segment VARCHAR(32),
    valid_from TIMESTAMP DEFAULT GETDATE(),
    valid_to TIMESTAMP,
    is_current BOOLEAN DEFAULT TRUE
)
DISTSTYLE KEY
DISTKEY (user_id)
SORTKEY (user_id, valid_from);


-- ì£¼ë¬¸ Fact í…Œì´ë¸”
CREATE TABLE fact_orders (
    order_id VARCHAR(64) PRIMARY KEY,
    order_date DATE NOT NULL,
    user_key BIGINT REFERENCES dim_users(user_key),
    date_key BIGINT,
    product_count INT,
    total_quantity INT,
    gross_amount DECIMAL(18,2),
    discount_amount DECIMAL(18,2),
    net_amount DECIMAL(18,2),
    _loaded_at TIMESTAMP DEFAULT GETDATE()
)
DISTSTYLE KEY
DISTKEY (user_key)
SORTKEY (order_date, user_key);


-- ë¶„ì„ ì¿¼ë¦¬ ì˜ˆì‹œ: ì›”ë³„ ì½”í˜¸íŠ¸ ë¦¬í…ì…˜
WITH cohort AS (
    SELECT
        user_id,
        DATE_TRUNC('month', first_event_date) AS cohort_month
    FROM dim_users
    WHERE is_current = TRUE
),
activity AS (
    SELECT
        e.user_id,
        DATE_TRUNC('month', e.event_date) AS activity_month
    FROM stg_events e
    GROUP BY 1, 2
),
cohort_activity AS (
    SELECT
        c.cohort_month,
        DATEDIFF('month', c.cohort_month, a.activity_month) AS months_since_signup,
        COUNT(DISTINCT a.user_id) AS active_users
    FROM cohort c
    JOIN activity a ON c.user_id = a.user_id
    GROUP BY 1, 2
)
SELECT
    cohort_month,
    months_since_signup,
    active_users,
    FIRST_VALUE(active_users) OVER (
        PARTITION BY cohort_month
        ORDER BY months_since_signup
    ) AS cohort_size,
    ROUND(
        active_users * 100.0 /
        FIRST_VALUE(active_users) OVER (
            PARTITION BY cohort_month
            ORDER BY months_since_signup
        ), 2
    ) AS retention_rate
FROM cohort_activity
ORDER BY cohort_month, months_since_signup;
```

### 4.3 ë°ì´í„° í’ˆì§ˆ í…ŒìŠ¤íŠ¸ (dbt)

```yaml
# models/marts/core/schema.yml
version: 2

models:
  - name: dim_users
    description: "ì‚¬ìš©ì Dimension í…Œì´ë¸”"
    columns:
      - name: user_id
        description: "ìœ ì € ê³ ìœ  ID"
        tests:
          - unique
          - not_null

      - name: user_segment
        description: "ìœ ì € ì„¸ê·¸ë¨¼íŠ¸"
        tests:
          - accepted_values:
              values: ['Buyer', 'New User', 'Active User']

  - name: fact_orders
    description: "ì£¼ë¬¸ Fact í…Œì´ë¸”"
    columns:
      - name: order_id
        tests:
          - unique
          - not_null

      - name: net_amount
        tests:
          - not_null
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: user_key
        tests:
          - relationships:
              to: ref('dim_users')
              field: user_key
```

---

## 5. ì¥ë‹¨ì 

### Data Warehouseì˜ ì¥ì 

| ì¥ì  | ì„¤ëª… |
|------|------|
| **ë¹ ë¥¸ ì¿¼ë¦¬** | ë¶„ì„ì— ìµœì í™”ëœ ì»¬ëŸ¼ ê¸°ë°˜ ì €ì¥ |
| **ë°ì´í„° í’ˆì§ˆ** | ìŠ¤í‚¤ë§ˆ ê°•ì œ, ì •í•©ì„± ë³´ì¥ |
| **í‘œì¤€í™”** | ì¼ê´€ëœ ì§€í‘œ ì •ì˜ |
| **BI ì—°ë™** | Tableau, Looker ë“± ì‰½ê²Œ ì—°ê²° |
| **ê±°ë²„ë„ŒìŠ¤** | ì ‘ê·¼ ì œì–´, ê°ì‚¬ ë¡œê·¸ |

### Data Warehouseì˜ ë‹¨ì 

| ë‹¨ì  | ì„¤ëª… |
|------|------|
| **ë¹„ìš©** | ìŠ¤í† ë¦¬ì§€ + ì»´í“¨íŒ… ë¹„ìš© ë°œìƒ |
| **ì§€ì—°** | ì‹¤ì‹œê°„ ë°ì´í„° ë°˜ì˜ ì–´ë ¤ì›€ |
| **ìœ ì—°ì„±** | ìŠ¤í‚¤ë§ˆ ë³€ê²½ì´ ì–´ë ¤ì›€ |
| **ë³µì¡ì„±** | ì„¤ê³„ ë° ìš´ì˜ì— ì „ë¬¸ì„± í•„ìš” |

### ì†”ë£¨ì…˜ë³„ ë¹„êµ

| í•­ëª© | Redshift | BigQuery | Snowflake |
|------|----------|----------|-----------|
| **ê³¼ê¸ˆ** | ë…¸ë“œ ê¸°ë°˜ | ìŠ¤ìº” ê¸°ë°˜ | í¬ë ˆë”§ ê¸°ë°˜ |
| **ì„œë²„ë¦¬ìŠ¤** | Serverless ì˜µì…˜ | ì™„ì „ ì„œë²„ë¦¬ìŠ¤ | ì»´í“¨íŒ…ë§Œ ì„œë²„ë¦¬ìŠ¤ |
| **í™•ì¥ì„±** | ìˆ˜ë™ ìŠ¤ì¼€ì¼ | ìë™ ìŠ¤ì¼€ì¼ | ì›¨ì–´í•˜ìš°ìŠ¤ í¬ê¸° ì¡°ì ˆ |
| **í´ë¼ìš°ë“œ** | AWS ì „ìš© | GCP ì „ìš© | ë©€í‹°í´ë¼ìš°ë“œ |
| **ëŸ¬ë‹ì»¤ë¸Œ** | ì¤‘ê°„ | ë‚®ìŒ | ë‚®ìŒ |

---

## 6. ë‚´ ìƒê°

```
(í•™ìŠµ í›„ ìì‹ ì˜ ìƒê°ì„ ì •ë¦¬í•´ë³´ì„¸ìš”)

- í˜„ì¬ ìš°ë¦¬ íŒ€ì˜ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ êµ¬ì¡°ëŠ”?

- ë¶„ì„íŒ€ê³¼ í˜‘ì—… ì‹œ ê°œì„ ì´ í•„ìš”í•œ ì ì€?

- Data Lakehouse ì•„í‚¤í…ì²˜ì˜ ì¥ì ì€?

```

---

## 7. ì¶”ê°€ ì§ˆë¬¸

### ê¸°ì´ˆ ë ˆë²¨
1. Data Lakeì™€ Data Warehouseì˜ ì°¨ì´ì ì€?

> **ë‹µë³€**: **Data Lake**ì™€ **Data Warehouse**ëŠ” ëª¨ë‘ ëŒ€ê·œëª¨ ë°ì´í„°ë¥¼ ì €ì¥í•˜ì§€ë§Œ ëª©ì ê³¼ êµ¬ì¡°ê°€ ë‹¤ë¦…ë‹ˆë‹¤. **Data Lake**: (1) **ëª©ì **: ì›ë³¸ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ì—¬ ë‚˜ì¤‘ì— ë‹¤ì–‘í•œ ìš©ë„ë¡œ í™œìš©. (2) **ìŠ¤í‚¤ë§ˆ**: Schema-on-Read (ì½ì„ ë•Œ ìŠ¤í‚¤ë§ˆ ì ìš©). ì €ì¥ ì‹œ ìŠ¤í‚¤ë§ˆ ê°•ì œ ì—†ìŒ. (3) **ë°ì´í„° í˜•ì‹**: JSON, CSV, Parquet, ì´ë¯¸ì§€, ë™ì˜ìƒ ë“± ëª¨ë“  í˜•ì‹. (4) **ë¹„ìš©**: ì €ë ´ (S3 ê¸°ì¤€ $0.023/GB). (5) **ì‚¬ìš©ì**: ë°ì´í„° ì—”ì§€ë‹ˆì–´, ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸. **Data Warehouse**: (1) **ëª©ì **: ë¶„ì„ê³¼ ë¦¬í¬íŒ…ì„ ìœ„í•´ ì •ì œëœ ë°ì´í„° ì œê³µ. (2) **ìŠ¤í‚¤ë§ˆ**: Schema-on-Write (ì €ì¥ ì‹œ ìŠ¤í‚¤ë§ˆ ê°•ì œ). í…Œì´ë¸” êµ¬ì¡°ê°€ ëª…í™•. (3) **ë°ì´í„° í˜•ì‹**: í…Œì´ë¸” í˜•ì‹ë§Œ. ì»¬ëŸ¼ê³¼ íƒ€ì…ì´ ì •ì˜ë¨. (4) **ë¹„ìš©**: ë¹„ìŒˆ (Redshift, BigQuery). (5) **ì‚¬ìš©ì**: ë¶„ì„ê°€, PM, ê²½ì˜ì§„. **ìµœì‹  íŠ¸ë Œë“œ - Data Lakehouse**: Delta Lake, Icebergë¥¼ ì‚¬ìš©í•˜ì—¬ Data Lakeì—ì„œ Data Warehouse ê¸°ëŠ¥(ACID, ìŠ¤í‚¤ë§ˆ ì ìš©)ì„ êµ¬í˜„. ë‘ ì„¸ê³„ì˜ ì¥ì ì„ ê²°í•©í•©ë‹ˆë‹¤.

2. Fact Tableê³¼ Dimension Tableì˜ ì—­í• ì€?

> **ë‹µë³€**: ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ **Fact Table**ê³¼ **Dimension Table**ì€ ë¶„ì„ì„ ìœ„í•œ í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤. **Fact Table (ì‚¬ì‹¤ í…Œì´ë¸”)**: (1) **ì—­í• **: ë¹„ì¦ˆë‹ˆìŠ¤ ì´ë²¤íŠ¸ì˜ ì¸¡ì •ê°’(Measure)ì„ ì €ì¥. "ë¬´ì—‡ì´ ì–¼ë§ˆë‚˜ ë°œìƒí–ˆëŠ”ê°€?" (2) **ë‚´ìš©**: ìˆ˜ëŸ‰, ê¸ˆì•¡, íšŸìˆ˜ ë“± ìˆ«ì ë°ì´í„°. ì£¼ë¡œ SUM, AVG, COUNTë¡œ ì§‘ê³„. (3) **ì˜ˆì‹œ**: `fact_orders` (order_id, user_key, product_key, order_amount, quantity). (4) **íŠ¹ì§•**: í–‰ ìˆ˜ê°€ ë§¤ìš° ë§ìŒ (ìˆ˜ì–µ~ìˆ˜ì‹­ì–µ í–‰). Dimension í‚¤ë¥¼ ì™¸ë˜í‚¤ë¡œ ì°¸ì¡°. **Dimension Table (ì°¨ì› í…Œì´ë¸”)**: (1) **ì—­í• **: ë¶„ì„ì˜ ê´€ì (ëˆ„ê°€, ì–¸ì œ, ì–´ë””ì„œ, ë¬´ì—‡ì„)ì„ ì œê³µ. (2) **ë‚´ìš©**: ì„¤ëª…ì ì¸ ì†ì„±. í…ìŠ¤íŠ¸, ì¹´í…Œê³ ë¦¬. (3) **ì˜ˆì‹œ**: `dim_users` (user_key, user_id, name, segment, country), `dim_products` (product_key, product_id, name, category, price). (4) **íŠ¹ì§•**: í–‰ ìˆ˜ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì ìŒ (ìˆ˜ì²œ~ìˆ˜ë°±ë§Œ). ìì£¼ ë³€í•˜ì§€ ì•ŠìŒ. **ë¶„ì„ ì¿¼ë¦¬ ì˜ˆì‹œ**:
> ```sql
> SELECT d.country, SUM(f.order_amount) AS total_sales
> FROM fact_orders f JOIN dim_users d ON f.user_key = d.user_key
> GROUP BY d.country;
> ```

3. Star Schemaì™€ Snowflake Schemaì˜ ì°¨ì´ëŠ”?

> **ë‹µë³€**: ë‘˜ ë‹¤ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ëª¨ë¸ë§ ë°©ì‹ì´ì§€ë§Œ ì •ê·œí™” ìˆ˜ì¤€ì´ ë‹¤ë¦…ë‹ˆë‹¤. **Star Schema (ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ)**: (1) **êµ¬ì¡°**: Fact Table ì¤‘ì‹¬ìœ¼ë¡œ Dimension Tableì´ ì§ì ‘ ì—°ê²°. Dimensionì´ ë¹„ì •ê·œí™”ë¨. (2) **ì¥ì **: ì¿¼ë¦¬ê°€ ë‹¨ìˆœ (JOIN íšŸìˆ˜ ì ìŒ), ì¿¼ë¦¬ ì„±ëŠ¥ì´ ë¹ ë¦„. (3) **ë‹¨ì **: ë°ì´í„° ì¤‘ë³µìœ¼ë¡œ ì €ì¥ ê³µê°„ ë” ì‚¬ìš©, Dimension ì—…ë°ì´íŠ¸ ì‹œ ì—¬ëŸ¬ ê³³ ìˆ˜ì •. (4) **ì˜ˆì‹œ**: `dim_products`ì— category_name, brand_nameì´ ì§ì ‘ í¬í•¨.
> ```
> fact_orders â”€â”€â”€â”€ dim_products (product_id, name, category_name, brand_name)
> ```
> **Snowflake Schema (ìŠ¤ë…¸ìš°í”Œë ˆì´í¬ ìŠ¤í‚¤ë§ˆ)**: (1) **êµ¬ì¡°**: Dimension Tableì´ ì •ê·œí™”ë˜ì–´ ì—¬ëŸ¬ í…Œì´ë¸”ë¡œ ë¶„ë¦¬. (2) **ì¥ì **: ë°ì´í„° ì¤‘ë³µ ìµœì†Œí™”, ì €ì¥ ê³µê°„ ì ˆì•½, ìœ ì§€ë³´ìˆ˜ ìš©ì´. (3) **ë‹¨ì **: ì¿¼ë¦¬ê°€ ë³µì¡ (JOIN ë§ìŒ), ì„±ëŠ¥ì´ ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¼. (4) **ì˜ˆì‹œ**: `dim_products` â†’ `dim_categories` â†’ `dim_brands`ë¡œ ë¶„ë¦¬.
> ```
> fact_orders â”€â”€ dim_products â”€â”€ dim_categories â”€â”€ dim_brands
> ```
> **ì‹¤ë¬´ ê¶Œì¥**: í˜„ëŒ€ í´ë¼ìš°ë“œ ì›¨ì–´í•˜ìš°ìŠ¤(Redshift, BigQuery)ëŠ” ì¡°ì¸ ì„±ëŠ¥ì´ ë›°ì–´ë‚˜ì„œ Star Schemaë¥¼ ë” ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¶„ì„ ì¿¼ë¦¬ ë‹¨ìˆœí™”ê°€ ìš°ì„ ì…ë‹ˆë‹¤.

### ì‹¬í™” ë ˆë²¨
4. SCD (Slowly Changing Dimension) Type 1, 2, 3ì˜ ì°¨ì´ëŠ”?

> **ë‹µë³€**: **SCD(Slowly Changing Dimension)**ëŠ” Dimension í…Œì´ë¸”ì˜ ê°’ì´ ì‹œê°„ì— ë”°ë¼ ë³€ê²½ë  ë•Œ ì´ë ¥ì„ ì–´ë–»ê²Œ ê´€ë¦¬í• ì§€ì— ëŒ€í•œ ì „ëµì…ë‹ˆë‹¤. **Type 1 - ë®ì–´ì“°ê¸°**: (1) **ë°©ì‹**: ë³€ê²½ ì‹œ ê¸°ì¡´ ê°’ì„ ìƒˆ ê°’ìœ¼ë¡œ ë®ì–´ì”€. ì´ë ¥ ì—†ìŒ. (2) **ìš©ë„**: ì´ë ¥ì´ ì¤‘ìš”í•˜ì§€ ì•Šì€ ê²½ìš°. ì˜ˆ: ì˜¤íƒ€ ìˆ˜ì •. (3) **ì˜ˆì‹œ**: ì‚¬ìš©ì ì´ë¦„ "Kim" â†’ "Kim Jr." ë³€ê²½ ì‹œ ê¸°ì¡´ í–‰ ì—…ë°ì´íŠ¸.
> **Type 2 - ìƒˆ í–‰ ì¶”ê°€**: (1) **ë°©ì‹**: ë³€ê²½ ì‹œ ìƒˆ í–‰ì„ ì¶”ê°€í•˜ê³  ìœ íš¨ ê¸°ê°„(valid_from, valid_to)ì„ ê´€ë¦¬. (2) **ìš©ë„**: ì „ì²´ ì´ë ¥ì´ ì¤‘ìš”í•œ ê²½ìš°. ì˜ˆ: ì‚¬ìš©ì ë“±ê¸‰ ë³€ê²½, ê°€ê²© ë³€ë™. (3) **ì˜ˆì‹œ**: ì‚¬ìš©ìê°€ "Standard" â†’ "Premium" ë“±ê¸‰ì´ ë˜ë©´ ìƒˆ í–‰ ì¶”ê°€. ì´ì „ í–‰ì€ valid_to ì„¤ì •.
> ```sql
> | user_key | user_id | segment | valid_from | valid_to   | is_current |
> |----------|---------|---------|------------|------------|------------|
> | 1        | u123    | Standard| 2023-01-01 | 2024-01-15 | false      |
> | 2        | u123    | Premium | 2024-01-15 | null       | true       |
> ```
> **Type 3 - ì´ì „/í˜„ì¬ ì»¬ëŸ¼**: (1) **ë°©ì‹**: í˜„ì¬ ê°’ê³¼ ì´ì „ ê°’ì„ ë³„ë„ ì»¬ëŸ¼ì— ì €ì¥. (2) **ìš©ë„**: ì§ì „ ê°’ë§Œ í•„ìš”í•œ ê²½ìš°. (3) **ì˜ˆì‹œ**: `current_segment`, `previous_segment` ì»¬ëŸ¼.
> **ì‹¤ë¬´**: Type 2ê°€ ê°€ì¥ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. dbtì˜ `snapshot` ê¸°ëŠ¥ìœ¼ë¡œ ìë™ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

5. Data Vault ëª¨ë¸ë§ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?

> **ë‹µë³€**: **Data Vault**ëŠ” Dan Linstedtê°€ ì œì•ˆí•œ ë°ì´í„° ëª¨ë¸ë§ ë°©ë²•ë¡ ìœ¼ë¡œ, ëŒ€ê·œëª¨ ì—”í„°í”„ë¼ì´ì¦ˆ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì— ì í•©í•©ë‹ˆë‹¤. **í•µì‹¬ êµ¬ì„± ìš”ì†Œ**: (1) **Hub**: ë¹„ì¦ˆë‹ˆìŠ¤ í‚¤(ê³ ìœ  ì‹ë³„ì)ë§Œ ì €ì¥. ì˜ˆ: `hub_users` (user_hub_key, user_id, load_date). (2) **Link**: Hub ê°„ì˜ ê´€ê³„ë¥¼ ì €ì¥. ì˜ˆ: `link_user_order` (user_hub_key, order_hub_key). (3) **Satellite**: Hub/Linkì˜ ìƒì„¸ ì†ì„±ì„ ì €ì¥. ì‹œê°„ì— ë”°ë¥¸ ë³€ê²½ ì´ë ¥ í¬í•¨. ì˜ˆ: `sat_user_profile` (user_hub_key, name, email, effective_date). **ì¥ì **: (1) ìœ ì—°ì„±: ìƒˆ ì†ŒìŠ¤ ì¶”ê°€ê°€ ìš©ì´. (2) ê°ì‚¬ ì¶”ì : ëª¨ë“  ë³€ê²½ ì´ë ¥ ë³´ì¡´. (3) ë³‘ë ¬ ë¡œë”©: Hub, Link, Satelliteë¥¼ ë…ë¦½ì ìœ¼ë¡œ ë¡œë”© ê°€ëŠ¥. **ë‹¨ì **: (1) ë³µì¡í•¨: Star Schemaë³´ë‹¤ í…Œì´ë¸” ìˆ˜ê°€ ë§ìŒ. (2) ì¿¼ë¦¬ ì–´ë ¤ì›€: ë¶„ì„ ì¿¼ë¦¬ì— ë§ì€ JOIN í•„ìš” â†’ Business Vaultë‚˜ Mart ë ˆì´ì–´ í•„ìš”. **ì‚¬ìš© ì‹œê¸°**: ì—¬ëŸ¬ ì†ŒìŠ¤ ì‹œìŠ¤í…œ í†µí•©, ê·œì œ ì‚°ì—…(ê¸ˆìœµ, ì˜ë£Œ)ì—ì„œ ê°ì‚¬ ì¶”ì  í•„ìˆ˜ì¼ ë•Œ. ìŠ¤íƒ€íŠ¸ì—…ì—ì„œëŠ” ë³´í†µ Star Schemaë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤.

6. Materialized ViewëŠ” ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?

> **ë‹µë³€**: **Materialized View**ëŠ” ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ë¬¼ë¦¬ì ìœ¼ë¡œ ì €ì¥í•˜ì—¬ ë°˜ë³µ ì‹¤í–‰ ì‹œ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. **ì‚¬ìš© ì‹œê¸°**: (1) **ë°˜ë³µ ì‹¤í–‰ ì¿¼ë¦¬**: ë™ì¼í•œ ë³µì¡í•œ ì¿¼ë¦¬ê°€ ìì£¼ ì‹¤í–‰ë  ë•Œ. ì˜ˆ: ì¼ì¼ ëŒ€ì‹œë³´ë“œ KPI. (2) **ë¬´ê±°ìš´ ì§‘ê³„**: ëŒ€ê·œëª¨ í…Œì´ë¸”ì˜ ì§‘ê³„ ê²°ê³¼ë¥¼ ë¯¸ë¦¬ ê³„ì‚°. ì˜ˆ: ì›”ë³„ ë§¤ì¶œ í•©ê³„. (3) **ëŠë¦° JOIN**: ì—¬ëŸ¬ í…Œì´ë¸” ì¡°ì¸ ê²°ê³¼ë¥¼ ì €ì¥í•˜ì—¬ ì†ë„ í–¥ìƒ. **ì˜ˆì‹œ (Redshift)**:
> ```sql
> CREATE MATERIALIZED VIEW mv_daily_sales AS
> SELECT
>     DATE(order_timestamp) AS order_date,
>     SUM(order_amount) AS total_sales,
>     COUNT(DISTINCT user_id) AS unique_buyers
> FROM fact_orders
> GROUP BY DATE(order_timestamp);
>
> -- ì‚¬ìš©
> SELECT * FROM mv_daily_sales WHERE order_date >= '2024-01-01';
>
> -- ìƒˆë¡œê³ ì¹¨
> REFRESH MATERIALIZED VIEW mv_daily_sales;
> ```
> **vs dbt Model**: dbtì˜ `materialized='table'`ë„ ìœ ì‚¬í•œ íš¨ê³¼. Materialized ViewëŠ” REFRESH ê¸°ëŠ¥ì´ ìˆì–´ ì¦ë¶„ ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. **ì£¼ì˜ì‚¬í•­**: ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´ ìƒˆë¡œê³ ì¹¨ì´ í•„ìš”í•˜ê³ , ìƒˆë¡œê³ ì¹¨ ì „ê¹Œì§€ëŠ” êµ¬ë²„ì „ ë°ì´í„°ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.

### ì‹¤ë¬´ ì‹œë‚˜ë¦¬ì˜¤
7. ë¶„ì„ ì§€í‘œê°€ ì¼ì¹˜í•˜ì§€ ì•Šì„ ë•Œ ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?

> **ë‹µë³€**: ë¶„ì„ ì§€í‘œ ë¶ˆì¼ì¹˜ëŠ” ë°ì´í„° íŒ€ì—ì„œ ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤. **í•´ê²° ë‹¨ê³„**: **(1) ë¬¸ì œ ì •ì˜**: ì–´ë–¤ ì§€í‘œê°€, ì–¼ë§ˆë‚˜, ì–´ëŠ ê¸°ê°„ì— ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ ëª…í™•íˆ íŒŒì•…. "DAUê°€ 10% ë‹¤ë¦„" vs "DAUê°€ 10ë§Œ ë‹¤ë¦„"ì€ ì ‘ê·¼ì´ ë‹¤ë¦„. **(2) ì›ì¸ ë¶„ì„**: (a) **ì •ì˜ ì°¨ì´**: user_id vs device_id, ë¡œê·¸ì¸ ì‚¬ìš©ì vs ì „ì²´ ì‚¬ìš©ì. (b) **í•„í„° ì¡°ê±´ ì°¨ì´**: íŠ¹ì • ì´ë²¤íŠ¸ ì œì™¸ ì—¬ë¶€, í…ŒìŠ¤íŠ¸ ê³„ì • ì œì™¸. (c) **íƒ€ì„ì¡´ ì°¨ì´**: UTC vs KST, ì¼ ê²½ê³„ ì‹œì . (d) **ë°ì´í„° ì†ŒìŠ¤ ì°¨ì´**: ì‹¤ì‹œê°„ í…Œì´ë¸” vs ì¼ì¼ ì§‘ê³„ í…Œì´ë¸”. (e) **ETL ì§€ì—°**: í•œìª½ë§Œ ìµœì‹  ë°ì´í„° ë°˜ì˜. **(3) ê²€ì¦ ì¿¼ë¦¬**:
> ```sql
> -- ë‘ ì†ŒìŠ¤ì˜ ê²°ê³¼ë¥¼ ë¹„êµ
> SELECT 'source_a' AS source, COUNT(DISTINCT user_id) AS dau FROM table_a WHERE ...
> UNION ALL
> SELECT 'source_b', COUNT(DISTINCT user_id) FROM table_b WHERE ...
> ```
> **(4) ê·¼ë³¸ í•´ê²°**: (a) ì§€í‘œ ì •ì˜ ë¬¸ì„œ(Data Dictionary) ì‘ì„± ë° ê³µìœ . (b) í‘œì¤€ ì¿¼ë¦¬/ëª¨ë¸ì„ dbtë¡œ ì •ì˜í•˜ì—¬ Single Source of Truth í™•ë¦½. (c) ëŒ€ì‹œë³´ë“œì™€ Ad-hoc ì¿¼ë¦¬ê°€ ê°™ì€ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ë„ë¡ í†µì¼.

8. ETL ì‹¤íŒ¨ ì‹œ ë°ì´í„° ì •í•©ì„±ì€ ì–´ë–»ê²Œ ë³´ì¥í•˜ë‚˜ìš”?

> **ë‹µë³€**: ETL ì‹¤íŒ¨ëŠ” ë°ì´í„° ì •í•©ì„±ì„ ê¹¨ëœ¨ë¦´ ìˆ˜ ìˆì–´ ì²´ê³„ì ì¸ ëŒ€ì‘ì´ í•„ìš”í•©ë‹ˆë‹¤. **ì˜ˆë°© ì¡°ì¹˜**: **(1) ë©±ë“±ì„± ì„¤ê³„**: ê°™ì€ ETLì„ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•´ë„ ê²°ê³¼ê°€ ê°™ë„ë¡. íŒŒí‹°ì…˜ ë‹¨ìœ„ ë®ì–´ì“°ê¸° ë˜ëŠ” UPSERT ì‚¬ìš©. **(2) íŠ¸ëœì­ì…˜ ì ìš©**: ì—¬ëŸ¬ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì–´ ì›ìì„± ë³´ì¥. **(3) ì˜ì¡´ì„± ê´€ë¦¬**: Airflow DAGì—ì„œ ì˜ì¡´ Taskê°€ ì„±ê³µí•´ì•¼ ë‹¤ìŒ Task ì‹¤í–‰. **ì‹¤íŒ¨ ì‹œ ë³µêµ¬**: **(1) ì¦‰ì‹œ ì•Œë¦¼**: Airflow `on_failure_callback`ìœ¼ë¡œ Slack/PagerDuty ì•Œë¦¼. **(2) ì˜í–¥ ë²”ìœ„ íŒŒì•…**: ì–´ë–¤ í…Œì´ë¸”ì´, ì–´ë–¤ ë‚ ì§œ ë°ì´í„°ê°€ ì˜í–¥ ë°›ì•˜ëŠ”ì§€ í™•ì¸. **(3) ë°±í•„(Backfill)**: ì‹¤íŒ¨í•œ ë‚ ì§œ ë²”ìœ„ì— ëŒ€í•´ ETL ì¬ì‹¤í–‰.
> ```bash
> airflow dags backfill -s 2024-01-15 -e 2024-01-15 my_etl_dag
> ```
> **(4) ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ì•Œë¦¼**: í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹œë³´ë“œ/ë¦¬í¬íŠ¸ ë‹´ë‹¹ìì—ê²Œ ì§€ì—° ì•ˆë‚´. **ë°ì´í„° ê²€ì¦**: (1) ETL í›„ ë ˆì½”ë“œ ìˆ˜ ê²€ì¦ (null ë¹„ìœ¨, ë²”ìœ„ ì²´í¬). (2) dbt testë¡œ ìë™ í’ˆì§ˆ ê²€ì‚¬. (3) ì–´ì œ ëŒ€ë¹„ ê¸‰ê²©í•œ ë³€í™” ê°ì§€ ì•Œë¦¼.

9. GDPR ì‚­ì œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ë‚˜ìš”?

> **ë‹µë³€**: GDPRì˜ "ìŠí˜€ì§ˆ ê¶Œë¦¬" ìš”ì²­ì€ ì›¨ì–´í•˜ìš°ìŠ¤ì˜ ëª¨ë“  í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤. **ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤**: **(1) ì‚­ì œ ëŒ€ìƒ ì‹ë³„**: ì‚¬ìš©ì ì‹ë³„ì(user_id, email)ë¡œ ì˜í–¥ë°›ëŠ” ëª¨ë“  í…Œì´ë¸” ëª©ë¡ ì‘ì„±. Data Catalog/Lineage ë„êµ¬ í™œìš©. **(2) ì‚­ì œ ì‹¤í–‰**:
> ```sql
> -- Dimension í…Œì´ë¸”
> DELETE FROM dim_users WHERE user_id = 'xxx';
>
> -- Fact í…Œì´ë¸” (ëŒ€ìš©ëŸ‰)
> -- ì˜µì…˜ 1: DELETE (ëŠë¦¼)
> DELETE FROM fact_orders WHERE user_id = 'xxx';
>
> -- ì˜µì…˜ 2: íŒŒí‹°ì…˜ ì¬ìƒì„± (ë¹ ë¦„, Delta Lake/Iceberg)
> DELETE FROM fact_orders WHERE user_id = 'xxx';
> OPTIMIZE fact_orders ZORDER BY (order_date);
> ```
> **(3) ë°±ì—…/ì•„ì¹´ì´ë¸Œ ì²˜ë¦¬**: Glacier ë°±ì—…ì—ì„œë„ ì‚­ì œ ë˜ëŠ” ë³µì› ì‹œ í•„í„°ë§ ì ìš©. **(4) ê°ì‚¬ ë¡œê·¸**: ì‚­ì œ ì‹¤í–‰ ì‹œê°„, ë²”ìœ„, ë‹´ë‹¹ì ê¸°ë¡. **ì•„í‚¤í…ì²˜ ê¶Œì¥**: (1) **Pseudonymization**: ë¶„ì„ í…Œì´ë¸”ì—ëŠ” í•´ì‹œëœ user_keyë§Œ ì €ì¥. ì›ë³¸ user_id â†” user_key ë§¤í•‘ í…Œì´ë¸” ë¶„ë¦¬. ì‚­ì œ ìš”ì²­ ì‹œ ë§¤í•‘ í…Œì´ë¸”ë§Œ ì‚­ì œí•˜ë©´ ë‚˜ë¨¸ì§€ ë°ì´í„°ëŠ” ìµëª…í™”ë¨. (2) **Retention Policy**: ì¼ì • ê¸°ê°„(ì˜ˆ: 2ë…„) ì´í›„ ìë™ ì‚­ì œ ì ìš©.

---

## 8. ëª¨ë°”ì¼ ì•±ì„ ìœ„í•œ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ëª¨ë¸ë§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ëª¨ë°”ì¼ ì•± ë¶„ì„ì„ ìœ„í•œ Star Schema ì„¤ê³„                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚    dim_date      â”‚
                                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                 â”‚  â”‚ date_key   â”‚  â”‚
                                 â”‚  â”‚ date       â”‚  â”‚
                                 â”‚  â”‚ day_of_weekâ”‚  â”‚
                                 â”‚  â”‚ week       â”‚  â”‚
                                 â”‚  â”‚ month      â”‚  â”‚
                                 â”‚  â”‚ quarter    â”‚  â”‚
                                 â”‚  â”‚ year       â”‚  â”‚
                                 â”‚  â”‚ is_weekend â”‚  â”‚
                                 â”‚  â”‚ is_holiday â”‚  â”‚
                                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   dim_users      â”‚                 â”‚                 â”‚  dim_products    â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                 â”‚                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚ user_key   â”‚  â”‚                 â”‚                 â”‚  â”‚product_key â”‚  â”‚
     â”‚  â”‚ user_id    â”‚  â”‚                 â”‚                 â”‚  â”‚product_id  â”‚  â”‚
     â”‚  â”‚ name       â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚name        â”‚  â”‚
     â”‚  â”‚ email_hash â”‚â—€â”€â”¼â”€â”€â”€â”€â”‚                         â”‚â”€â”€â”€â”€â”¼â”€â–¶â”‚category    â”‚  â”‚
     â”‚  â”‚ segment    â”‚  â”‚    â”‚     FACT_APP_EVENTS     â”‚    â”‚  â”‚price       â”‚  â”‚
     â”‚  â”‚ country    â”‚  â”‚    â”‚                         â”‚    â”‚  â”‚brand       â”‚  â”‚
     â”‚  â”‚ signup_dateâ”‚  â”‚    â”‚ event_id                â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚  â”‚ platform   â”‚  â”‚    â”‚ event_timestamp         â”‚    â”‚                  â”‚
     â”‚  â”‚ app_versionâ”‚  â”‚    â”‚ user_key (FK)           â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚  â”‚ first_seen â”‚  â”‚    â”‚ date_key (FK)           â”‚
     â”‚  â”‚ last_seen  â”‚  â”‚    â”‚ product_key (FK)        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ valid_from â”‚  â”‚    â”‚ session_key (FK)        â”‚    â”‚  dim_sessions   â”‚
     â”‚  â”‚ valid_to   â”‚  â”‚    â”‚ event_name              â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚ is_current â”‚  â”‚    â”‚ screen_name             â”‚    â”‚  â”‚session_key â”‚  â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚ event_value             â”‚â”€â”€â”€â”€â”¼â”€â–¶â”‚session_id  â”‚  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ device_type             â”‚    â”‚  â”‚start_time  â”‚  â”‚
                             â”‚ os_version              â”‚    â”‚  â”‚end_time    â”‚  â”‚
                             â”‚                         â”‚    â”‚  â”‚duration_secâ”‚  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚event_count â”‚  â”‚
                                                            â”‚  â”‚platform    â”‚  â”‚
                                                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### dbtë¥¼ ì‚¬ìš©í•œ í…Œì´ë¸” ì •ì˜ ì˜ˆì‹œ

```sql
-- models/marts/dim_users.sql
-- ì‚¬ìš©ì Dimension í…Œì´ë¸” (SCD Type 2)

{{ config(
    materialized='table',
    unique_key='user_key',
    tags=['dimension', 'core']
) }}

WITH source_users AS (
    SELECT * FROM {{ ref('stg_users') }}
),

user_first_activity AS (
    SELECT
        user_id,
        MIN(event_date) AS first_seen_date,
        MAX(event_date) AS last_seen_date,
        COUNT(DISTINCT event_date) AS active_days
    FROM {{ ref('stg_app_events') }}
    GROUP BY user_id
),

final AS (
    SELECT
        -- Surrogate Key
        {{ dbt_utils.generate_surrogate_key(['u.user_id', 'u.updated_at']) }} AS user_key,

        -- Natural Key
        u.user_id,

        -- Attributes
        u.user_name,
        {{ dbt_utils.safe_cast('u.email', 'STRING') }} AS email_hash,  -- í•´ì‹œëœ ì´ë©”ì¼
        u.country,
        u.platform,
        u.app_version,

        -- Derived Attributes
        CASE
            WHEN a.active_days >= 30 THEN 'Power User'
            WHEN a.active_days >= 7 THEN 'Active User'
            WHEN a.active_days >= 1 THEN 'Casual User'
            ELSE 'Dormant'
        END AS user_segment,

        -- Dates
        u.created_at AS signup_date,
        a.first_seen_date,
        a.last_seen_date,
        a.active_days,

        -- SCD Type 2 Columns
        u.updated_at AS valid_from,
        LEAD(u.updated_at) OVER (PARTITION BY u.user_id ORDER BY u.updated_at) AS valid_to,
        CASE
            WHEN LEAD(u.updated_at) OVER (PARTITION BY u.user_id ORDER BY u.updated_at) IS NULL
            THEN TRUE ELSE FALSE
        END AS is_current

    FROM source_users u
    LEFT JOIN user_first_activity a ON u.user_id = a.user_id
)

SELECT * FROM final
```

```sql
-- models/marts/fact_app_events.sql
-- ì•± ì´ë²¤íŠ¸ Fact í…Œì´ë¸”

{{ config(
    materialized='incremental',
    unique_key='event_id',
    partition_by={
      "field": "event_date",
      "data_type": "date",
      "granularity": "day"
    },
    cluster_by=['user_id', 'event_name'],
    tags=['fact', 'core']
) }}

WITH events AS (
    SELECT * FROM {{ ref('stg_app_events') }}
    {% if is_incremental() %}
    WHERE event_date > (SELECT MAX(event_date) FROM {{ this }})
    {% endif %}
),

users AS (
    SELECT user_key, user_id
    FROM {{ ref('dim_users') }}
    WHERE is_current = TRUE
),

sessions AS (
    SELECT session_key, session_id
    FROM {{ ref('dim_sessions') }}
),

dates AS (
    SELECT date_key, date
    FROM {{ ref('dim_date') }}
),

final AS (
    SELECT
        -- Keys
        e.event_id,
        COALESCE(u.user_key, -1) AS user_key,  -- -1 for unknown
        COALESCE(d.date_key, -1) AS date_key,
        COALESCE(s.session_key, -1) AS session_key,

        -- Event Details
        e.event_timestamp,
        e.event_date,
        e.event_name,
        e.screen_name,
        e.event_value,

        -- Device Context
        e.device_type,
        e.platform,
        e.os_version,
        e.app_version,

        -- Metadata
        e._loaded_at

    FROM events e
    LEFT JOIN users u ON e.user_id = u.user_id
    LEFT JOIN dates d ON e.event_date = d.date
    LEFT JOIN sessions s ON e.session_id = s.session_id
)

SELECT * FROM final
```

---

## 9. ì‹¤ë¬´ì—ì„œ ìì£¼ ê²ªëŠ” ì›¨ì–´í•˜ìš°ìŠ¤ ë¬¸ì œì™€ í•´ê²°ì±…

### ë¬¸ì œ 1: ì¿¼ë¦¬ ì„±ëŠ¥ ì €í•˜

| ì¦ìƒ | ì›ì¸ | í•´ê²°ì±… |
|------|------|--------|
| ëŒ€ì‹œë³´ë“œ ë¡œë”©ì´ ëŠë¦¼ | Fact í…Œì´ë¸” Full Scan | ë‚ ì§œ íŒŒí‹°ì…˜ + í´ëŸ¬ìŠ¤í„°ë§ ì ìš© |
| JOINì´ ì˜¤ë˜ ê±¸ë¦¼ | Dimension í‚¤ ë¶ˆì¼ì¹˜ | Surrogate Key ì¼ê´€ì„± í™•ë³´ |
| ì§‘ê³„ ì¿¼ë¦¬ê°€ ëŠë¦¼ | ë§¤ë²ˆ ì›ë³¸ì—ì„œ ê³„ì‚° | Pre-aggregated í…Œì´ë¸” ìƒì„± |

```sql
-- Redshift: íŒŒí‹°ì…˜ ë° ì •ë ¬ í‚¤ ì„¤ì •
CREATE TABLE fact_app_events (
    event_id VARCHAR(64),
    event_date DATE,
    user_key BIGINT,
    event_name VARCHAR(100),
    event_value DECIMAL(18,2)
)
DISTSTYLE KEY
DISTKEY (user_key)
SORTKEY (event_date, user_key);

-- BigQuery: íŒŒí‹°ì…˜ ë° í´ëŸ¬ìŠ¤í„°ë§
CREATE TABLE dataset.fact_app_events
PARTITION BY event_date
CLUSTER BY user_id, event_name
AS SELECT * FROM ...
```

### ë¬¸ì œ 2: ë°ì´í„° ì‹ ì„ ë„ ë¶€ì¡±

| ì¦ìƒ | ì›ì¸ | í•´ê²°ì±… |
|------|------|--------|
| ì˜¤ëŠ˜ ë°ì´í„°ê°€ ì•ˆ ë³´ì„ | ë°°ì¹˜ ETLì´ ìµì¼ ì‹¤í–‰ | ì‹¤ì‹œê°„/ì¤€ì‹¤ì‹œê°„ íŒŒì´í”„ë¼ì¸ ì¶”ê°€ |
| ëŒ€ì‹œë³´ë“œê°€ í•­ìƒ í•˜ë£¨ ëŠ¦ìŒ | ETL ìŠ¤ì¼€ì¤„ ë¬¸ì œ | ì—…ë¬´ ì‹œê°„ ì „ ì™„ë£Œë˜ë„ë¡ ì¡°ì • |
| ìµœì‹  ì£¼ë¬¸ì´ ë°˜ì˜ ì•ˆ ë¨ | CDC ì§€ì—° | Debezium + Kafkaë¡œ ì‹¤ì‹œê°„ ë™ê¸°í™” |

```python
# Airflow DAG ìŠ¤ì¼€ì¤„ ì˜ˆì‹œ
# í•œêµ­ ì‹œê°„ ì˜¤ì „ 6ì‹œì— ì „ë‚  ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ
schedule_interval='0 21 * * *'  # UTC 21ì‹œ = KST 06ì‹œ

# ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œì‘ ì „ ë°ì´í„° ì¤€ë¹„
# 06:00 KST - ETL ì™„ë£Œ
# 07:00 KST - ë°ì´í„° ê²€ì¦
# 08:00 KST - ëŒ€ì‹œë³´ë“œ í™•ì¸ ê°€ëŠ¥
```

### ë¬¸ì œ 3: ì €ì¥ ë¹„ìš© ì¦ê°€

| ì¦ìƒ | ì›ì¸ | í•´ê²°ì±… |
|------|------|--------|
| Redshift ë¹„ìš© ê¸‰ì¦ | ë¶ˆí•„ìš”í•œ ì´ë ¥ ë°ì´í„° | ì˜¤ë˜ëœ ë°ì´í„° S3ë¡œ ì–¸ë¡œë“œ |
| BigQuery ë¹„ìš© ê¸‰ì¦ | ê³¼ë„í•œ Full Scan | íŒŒí‹°ì…˜ í•„í„° í•„ìˆ˜í™”, BI Tool ìºì‹± |
| ì¤‘ë³µ í…Œì´ë¸” ì¦ê°€ | ëª¨ë¸ ê´€ë¦¬ ë¶€ì¬ | dbtë¡œ ëª¨ë¸ í‘œì¤€í™”, ë¯¸ì‚¬ìš© í…Œì´ë¸” ì‚­ì œ |

```sql
-- Redshift: ì˜¤ë˜ëœ ë°ì´í„° S3ë¡œ ì–¸ë¡œë“œ
UNLOAD ('SELECT * FROM fact_events WHERE event_date < ''2023-01-01''')
TO 's3://archive-bucket/fact_events/'
IAM_ROLE 'arn:aws:iam::xxx:role/RedshiftUnloadRole'
PARQUET;

-- ì´í›„ ì›ë³¸ í…Œì´ë¸”ì—ì„œ ì‚­ì œ
DELETE FROM fact_events WHERE event_date < '2023-01-01';
VACUUM fact_events;
```

---

## ì°¸ê³  ìë£Œ

- [dbt ê³µì‹ ë¬¸ì„œ](https://docs.getdbt.com/)
- [Amazon Redshift ê°œë°œì ê°€ì´ë“œ](https://docs.aws.amazon.com/redshift/)
- [Google BigQuery ë¬¸ì„œ](https://cloud.google.com/bigquery/docs)
- [Data Warehouse Toolkit (Kimball)](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/books/)
- [dbt Best Practices](https://docs.getdbt.com/guides/best-practices)
- [Snowflake ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ](https://docs.snowflake.com/en/user-guide/performance-guide.html)
